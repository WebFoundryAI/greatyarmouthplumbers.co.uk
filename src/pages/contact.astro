---
import BaseLayout from '../layouts/BaseLayout.astro';
import Breadcrumbs from '../components/Breadcrumbs.astro';
import { Icon } from 'astro-icon/components';
import { business } from '../data/business';
import { serviceTypes } from '../data/serviceTypes';

const title = 'Contact Us | Great Yarmouth Plumbers';
const description = 'Contact Great Yarmouth Plumbers for a free quote. Call 01493 334000 or fill in our online form. Emergency plumbing available 24/7.';

const contactEmailHtml = `<!--email_off--><a href="mailto:${business.email}" class="font-semibold text-gray-900 hover:text-brand-700">${business.email}</a><!--email_on-->`;

const breadcrumbs = [
  { label: 'Home', href: '/' },
  { label: 'Contact' },
];
---

<BaseLayout {title} {description}>
  <Fragment slot="head">
    <script type="application/ld+json" set:html={JSON.stringify({
      '@context': 'https://schema.org',
      '@graph': [
        {
          '@type': 'ContactPage',
          name: title,
          description: description,
          url: `${business.website}/contact/`,
          mainEntity: {
            '@type': business.schemaType,
            '@id': `${business.website}/#business`,
            name: business.name,
            telephone: business.phone,
            email: business.email,
            address: {
              '@type': 'PostalAddress',
              streetAddress: business.address.street,
              addressLocality: business.address.city,
              addressRegion: business.address.county,
              postalCode: business.address.postcode,
              addressCountry: 'GB',
            },
          },
        },
        {
          '@type': 'BreadcrumbList',
          itemListElement: breadcrumbs.map((item, i) => ({
            '@type': 'ListItem',
            position: i + 1,
            name: item.label,
            ...(item.href ? { item: `${business.website}${item.href}` } : {}),
          })),
        },
      ],
    })} />
  </Fragment>

  <Breadcrumbs items={breadcrumbs} />

  <!-- Hero -->
  <section class="bg-gradient-to-br from-brand-900 to-brand-800 py-16 text-white">
    <div class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8">
      <div class="max-w-3xl">
        <h1 class="text-4xl font-extrabold tracking-tight sm:text-5xl">Contact Us</h1>
        <p class="mt-4 text-lg text-brand-100">
          Have a plumbing problem or need a quote? Get in touch and we will get back to you as soon as possible. For emergencies, call us directly.
        </p>
      </div>
    </div>
  </section>

  <!-- Contact Content -->
  <section class="bg-white py-16">
    <div class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8">
      <div class="grid gap-12 lg:grid-cols-5">
        <!-- Form -->
        <div class="lg:col-span-3">
          <h2 class="text-2xl font-bold text-gray-900">Send Us a Message</h2>
          <p class="mt-2 text-gray-600">
            Fill in the form below and we will get back to you within a few hours during business hours.
          </p>
          <!-- TODO: Connect to form backend (e.g. Formspree, Netlify Forms, or custom API) -->
          <form action="#" method="POST" class="mt-8 space-y-6">
            <div class="grid gap-6 sm:grid-cols-2">
              <div>
                <label for="name" class="block text-sm font-medium text-gray-700">Your Name *</label>
                <input
                  type="text"
                  id="name"
                  name="name"
                  required
                  placeholder="John Smith"
                  class="mt-1 block w-full rounded-lg border border-gray-300 px-4 py-3 text-gray-900 shadow-sm placeholder:text-gray-400 focus:border-brand-500 focus:ring-2 focus:ring-brand-500/20 focus:outline-none"
                />
              </div>
              <div>
                <label for="email" class="block text-sm font-medium text-gray-700">Email Address *</label>
                <input
                  type="email"
                  id="email"
                  name="email"
                  required
                  placeholder="john@example.co.uk"
                  class="mt-1 block w-full rounded-lg border border-gray-300 px-4 py-3 text-gray-900 shadow-sm placeholder:text-gray-400 focus:border-brand-500 focus:ring-2 focus:ring-brand-500/20 focus:outline-none"
                />
              </div>
            </div>
            <div class="grid gap-6 sm:grid-cols-2">
              <div>
                <label for="phone" class="block text-sm font-medium text-gray-700">Phone Number</label>
                <input
                  type="tel"
                  id="phone"
                  name="phone"
                  placeholder="01493 000000"
                  class="mt-1 block w-full rounded-lg border border-gray-300 px-4 py-3 text-gray-900 shadow-sm placeholder:text-gray-400 focus:border-brand-500 focus:ring-2 focus:ring-brand-500/20 focus:outline-none"
                />
              </div>
              <div>
                <label for="service" class="block text-sm font-medium text-gray-700">Service Needed</label>
                <select
                  id="service"
                  name="service"
                  class="mt-1 block w-full rounded-lg border border-gray-300 px-4 py-3 text-gray-900 shadow-sm focus:border-brand-500 focus:ring-2 focus:ring-brand-500/20 focus:outline-none"
                >
                  <option value="">Select a service</option>
                  {serviceTypes.map((s) => (
                    <option value={s.slug}>{s.name}</option>
                  ))}
                  <option value="other">Other / Not Sure</option>
                </select>
              </div>
            </div>
            <div>
              <label for="message" class="block text-sm font-medium text-gray-700">Message *</label>
              <textarea
                id="message"
                name="message"
                rows="5"
                required
                placeholder="Please describe your plumbing issue or what you need help with..."
                class="mt-1 block w-full rounded-lg border border-gray-300 px-4 py-3 text-gray-900 shadow-sm placeholder:text-gray-400 focus:border-brand-500 focus:ring-2 focus:ring-brand-500/20 focus:outline-none"
              ></textarea>
            </div>
            <button
              type="submit"
              class="inline-flex items-center gap-2 rounded-lg bg-brand-600 px-8 py-4 text-lg font-bold text-white shadow-md transition hover:bg-brand-700 focus:outline-none focus:ring-2 focus:ring-brand-500 focus:ring-offset-2"
            >
              <Icon name="lucide:send" class="h-5 w-5" />
              Send Message
            </button>
          </form>
        </div>

        <!-- Sidebar -->
        <div class="lg:col-span-2">
          <!-- Emergency Note -->
          <div class="mb-8 rounded-xl bg-red-50 p-6 ring-1 ring-red-100">
            <div class="flex items-start gap-3">
              <Icon name="lucide:alert-triangle" class="mt-0.5 h-6 w-6 flex-shrink-0 text-red-600" />
              <div>
                <h3 class="font-bold text-red-900">Plumbing Emergency?</h3>
                <p class="mt-1 text-sm text-red-700">
                  For urgent issues like burst pipes, flooding, or gas leaks, do not wait for a form response. Call us now for immediate help.
                </p>
                <a
                  href={business.phoneHref}
                  class="mt-3 inline-flex items-center gap-2 rounded-lg bg-red-600 px-6 py-3 text-sm font-bold text-white transition hover:bg-red-700"
                >
                  <Icon name="lucide:phone" class="h-4 w-4" />
                  {business.phone}
                </a>
              </div>
            </div>
          </div>

          <!-- Contact Details -->
          <div class="rounded-xl bg-gray-50 p-6">
            <h3 class="text-lg font-bold text-gray-900">Contact Details</h3>
            <div class="mt-6 space-y-5">
              <div class="flex items-start gap-3">
                <Icon name="lucide:phone" class="mt-0.5 h-5 w-5 flex-shrink-0 text-brand-600" />
                <div>
                  <p class="text-sm font-medium text-gray-500">Phone</p>
                  <a href={business.phoneHref} class="font-semibold text-gray-900 hover:text-brand-700">
                    {business.phone}
                  </a>
                </div>
              </div>
              <div class="flex items-start gap-3">
                <Icon name="lucide:mail" class="mt-0.5 h-5 w-5 flex-shrink-0 text-brand-600" />
                <div>
                  <p class="text-sm font-medium text-gray-500">Email</p>
                  <Fragment set:html={contactEmailHtml} />
                </div>
              </div>
              <div class="flex items-start gap-3">
                <Icon name="lucide:map-pin" class="mt-0.5 h-5 w-5 flex-shrink-0 text-brand-600" />
                <div>
                  <p class="text-sm font-medium text-gray-500">Address</p>
                  <p class="font-semibold text-gray-900">
                    {business.address.street}<br />
                    {business.address.city}, {business.address.county}<br />
                    {business.address.postcode}
                  </p>
                </div>
              </div>
            </div>

            <!-- Business Hours -->
            <div class="mt-8 border-t border-gray-200 pt-6">
              <h3 class="text-lg font-bold text-gray-900">Business Hours</h3>
              <div class="mt-4 space-y-3">
                {business.hours.map((h) => (
                  <div class="flex items-center justify-between text-sm">
                    <span class="font-medium text-gray-700">{h.days}</span>
                    <span class="text-gray-600">{h.hours}</span>
                  </div>
                ))}
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>
  <!-- What to Expect -->
  <section class="bg-gray-50 py-16">
    <div class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8">
      <div class="max-w-3xl">
        <h2 class="text-2xl font-extrabold text-gray-900">What to Expect When You Contact Us</h2>
        <div class="mt-6 space-y-4 text-gray-600 leading-relaxed">
          <p>
            When you get in touch with {business.name}, you will speak to a friendly member of our team who will take the time to understand your plumbing problem. We will ask a few questions about the issue, your property, and your preferred availability so that we can arrange a visit at a time that suits you.
          </p>
          <p>
            For non-emergency enquiries submitted through our contact form, we aim to respond within a few hours during normal business hours. If your message arrives outside of working hours, we will get back to you first thing the following morning. For urgent problems such as burst pipes, flooding, or gas leaks, we strongly recommend calling us directly on {business.phone} so we can dispatch a plumber to you immediately.
          </p>
          <p>
            Before any work begins, our plumber will carry out an assessment and provide you with a clear, written quote. There are no hidden call-out fees and no surprises. If additional work is needed beyond the original quote, we will always discuss it with you and get your approval before proceeding.
          </p>
          <p>
            We serve homes and businesses across Great Yarmouth, Gorleston-on-Sea, Caister-on-Sea, Bradwell, Lowestoft, and surrounding areas in Norfolk and Suffolk. Whether you need a simple repair or a larger project, we are happy to provide a free, no-obligation estimate. Get in touch today and let us take care of your plumbing.
          </p>
        </div>
      </div>
    </div>
  </section>
</BaseLayout>
